//AnimateHtml
var AnimateHtml={index:"./",flash_dir:"./",config:{},page1:"",page2:"",transition:"",iframe_div:null,iframe:null,flash_div:null,flash:null,iframe_td:null,scrollgap:null,flash_ready:!1,iframe_ready:!1,init:function(){with(this){dispatchEvent("init");iframe_div=document.createElement("div");iframe_div.className="ah_frame_div full_width";document.body.appendChild(iframe_div);var a=document.createElement("table");a.cellPadding=a.cellSpacing=0;a.border=0;var b=a.insertRow(0);b.vAlign="top";iframe_td=b.insertCell(0); iframe_td.align="center";scrollgap=b.insertCell(1);scrollgap.id="ah_scrollgap";scrollgap.className="ah_scrollgap";scrollgap.vAlign="top";iframe_div.appendChild(a);iframe=document.createElement("iframe");iframe.className="ah_frame";iframe.frameBorder=0;iframe.scrolling="no";iframe.src=web_dir+getUrlMask();$(iframe).load(onPageLoad);iframe_td.appendChild(iframe);flash_div=document.createElement("div");flash_div.className="ah_flash_div full_width";flash_div.id="ah_flash_div";document.body.appendChild(flash_div); a=document.createElement("div");a.id="ah_flash";flash_div.appendChild(a);var a={},c;for(c in config)a[c]=config[c];swfobject.embedSWF(flash_dir+"/ah.swf","ah_flash","0","100%","9.0.0","expressInstall.swf",a,{allowScriptAccess:"always",scale:"noscale",wmode:"transparent"},{styleclass:"full_width"});flash=getFlash("ah_flash")}},getFlash:function(a){return-1!=navigator.appName.indexOf("Microsoft")?window[a]:document[a]},onPageLoad:function(){with(AnimateHtml)onDebug("page loaded"),startCheckHistory(), document.title=iframe.contentWindow.document.title,setFrameHeight(),watchFrameHeight(),hasScroll()&&compensateScrollgap(!1),$(iframe).contents().find("a:not(a.ah_ignore)").click(function(){return onLinkClick(this)}),$(iframe).contents().find("body, html").css("overflow","hidden"),transition&&hideDynamic(!0),iframe_ready=!0,flash_ready&&(onDebug("do start"),flash.start())},onLinkClick:function(a){var b=AnimateHtml.getLinkInfo(a);return b.internal||"blank"==b.target||"http"!=b.protocol?!0:$(a).hasClass("ah_no_transition")? (AnimateHtml.stopCheckHistory(),AnimateHtml.page2=b.absolute,AnimateHtml.setFrameUrl(),!1):AnimateHtml.swap(a,AnimateHtml.parseTransitionType(a))},swap:function(a,b){with(AnimateHtml){var c=getUrlInfo(a);if(!isSameDomain(c.domain)||isIgnored(c))return window.top.location.href=a.href,!0;flash_ready=iframe_ready=!1;page1=getFrameUrl();page1==index&&(page1=page1.replace("?wpt-wrapped=1",""));page2=(c.absolute+"").split("#")[0];page2==index&&(page2=page2.replace("?wpt-wrapped=1",""));if(page1==page2)return!1; "/"==page2&&(page2="");stopCheckHistory();transition=b;unwatchFrameHeight();dispatchEvent("before_start");$(".ah_loader").show();block();hideDynamic();scrollFrame();return!1}},onFlashInit:function(){this.hideFlash()},onPreviewReady:function(a){this.onDebug("preview ready");this.resizeFrame(a)},onTransitionReady:function(){with(this)onDebug("transition is ready"),flash_ready=!0,iframe_ready&&(onDebug("do start"),flash.start())},onStart:function(){with(this)dispatchEvent("start"),$(".ah_loader").hide()}, onEnd:function(){with(this)dispatchEvent("stop"),hideFlash(),showDynamic(),resizeFrameBack(),transition="",iframe_ready=flash_ready=!1,startCheckHistory()},onFail:function(){with(this)dispatchEvent("fail"),hideFlash(),unblock(),resizeFrameBack(),transition="",flash_ready=!1,setFrameUrl(),startCheckHistory()},onDebug:function(){}};

//Events
window.AnimateHtml&&(AnimateHtml.listeners={},AnimateHtml.addEventListener=function(a,b,c,d){with(this)if(d={obj:c,func:b,source:d},listeners[a]){for(var f=listeners[a],e=0;e<f.length;e++)if(f[e].obj){if(f[e].func==b&&f[e].obj==c)return}else if(f[e].func==b)return;listeners[a].push(d)}else listeners[a]=[d]},AnimateHtml.removeEventListener=function(a,b,c){with(this)if(listeners[a])for(var a=listeners[a],d=a.length-1;0<=d;d--)a[d].obj?a[d].func==b&&a[d].obj==c&&a.splice(d,1):a[d].func==b&&a.splice(d, 1)},AnimateHtml.removeFrameListeners=function(){with(this)for(var a in listeners)for(var b=listeners[a],c=b.length-1;0<=c;c--)"iframe"==b[c].source&&b.splice(c,1)},AnimateHtml.dispatchEvent=function(a){with(this){onDebug(a);var a="string"==typeof a?{type:a}:a,b=listeners[a.type];if(!b||!b.length)return;for(var c=0;c<b.length;c++)b[c].func.call(b[c].obj,a)}});

//UI
window.AnimateHtml&&(AnimateHtml.blocker=null,AnimateHtml.page_w=null,AnimateHtml.scrollbar_w=0,AnimateHtml.resize_tween="easeInQuint",AnimateHtml.resize_time=400,AnimateHtml.scroll_tween="easeOutSine",AnimateHtml.scroll_time=400,AnimateHtml.dynamic_tween="linear",AnimateHtml.dynamic_time=400,AnimateHtml.frame_h_int=0,AnimateHtml.prev_frame_h=0,AnimateHtml.addEventListener("init",function(){with(AnimateHtml)scrollbar_w=getScrollBarWidth(),blocker=document.getElementById("ah_blocker")}),AnimateHtml.block= function(){with(this)blocker.style.display="block",dispatchEvent("block")},AnimateHtml.unblock=function(){with(this)blocker.style.display="none",hasScroll()&&compensateScrollgap(!1),dispatchEvent("unblock")},AnimateHtml.compensateScrollgap=function(b){with(this)scrollgap.style.width=b?scrollbar_w+"px":0,iframe_td.width=""},AnimateHtml.hideFlash=function(){with(this)iframe_div.style.left=0,flash_div.style.left="-10000px"},AnimateHtml.showFlash=function(){with(this)flash_div.style.left=$(window).width()< page_w?0:-scrollbar_w/2+"px",flash.onShow(),iframe_div.style.left="-10000px"},AnimateHtml.hideDynamic=function(b){with(this){var a={type:"hide_dynamic"};b?(a.animated=!1,$(iframe).contents().find(".ah_dynamic").css("display","none")):(a.animated=!0,$(iframe).contents().find(".ah_dynamic").fadeOut(dynamic_time));dispatchEvent(a)}},AnimateHtml.showDynamic=function(){with(this)dispatchEvent("show_dynamic"),$(iframe).contents().find(".ah_dynamic").slideDown(dynamic_time)},AnimateHtml.scrollFrame=function(){with(this){frameScrollTop(0); if(!iframe_div.scrollTop){setTimeout(function(){flash.prepareTransition(transition,page1,page2)},dynamic_time+100);return}$(iframe_div).animate({scrollTop:0},scroll_time,scroll_tween,function(){flash.prepareTransition(transition,page1,page2)})}},AnimateHtml.resizeFrame=function(b){with(this){var a=$(iframe);resize_time&&b<a.width()?a.animate({width:b},resize_time,resize_tween,function(){transition?(showFlash(),setFrameUrl()):(hideFlash(),resizeFrameBack())}):transition?(showFlash(),setFrameUrl()): (hideFlash(),resizeFrameBack())}},AnimateHtml.resizeFrameBack=function(){with(this)resize_time?$(iframe).animate({width:$(iframe_td).width()},resize_time,resize_tween,function(){iframe.style.width="";unblock()}):(iframe.style.width="",unblock())},AnimateHtml.getScrollBarWidth=function(){var b=document.createElement("p");b.style.width="100%";b.style.height="200px";var a=document.createElement("div");a.style.position="absolute";a.style.top="0px";a.style.left="0px";a.style.visibility="hidden";a.style.width= "200px";a.style.height="150px";a.style.overflow="hidden";a.appendChild(b);document.body.appendChild(a);var c=b.offsetWidth;a.style.overflow="scroll";b=b.offsetWidth;c==b&&(b=a.clientWidth);document.body.removeChild(a);return c-b},AnimateHtml.frameScrollTop=function(b){var a=AnimateHtml.iframe.contentWindow.document.documentElement;void 0!=b&&(a.scrollTop=b);return a.scrollTop},AnimateHtml.getFrameSize=function(){var b=AnimateHtml.iframe.contentWindow.document,a=b.body;if(!a)return!1;var c=b.documentElement, b=Math.max(a.scrollWidth,c.scrollWidth,a.offsetWidth,c.offsetWidth,a.clientWidth,c.clientWidth),a=Math.max(a.scrollHeight,c.scrollHeight,a.offsetHeight,c.offsetHeight,a.clientHeight,c.clientHeight);return{w:b,h:a}},AnimateHtml.setFrameHeight=function(){with(AnimateHtml){iframe.style.height=0;var b=getFrameSize();if(!b)return;iframe.style.height=b.h+"px";prev_frame_h=b.h}},AnimateHtml.checkFrameHeight=function(){with(AnimateHtml){var b=getFrameSize();if(!b)return;b.h!=1*iframe.style.height.replace("px", "")&&setFrameHeight()}},AnimateHtml.watchFrameHeight=function(){with(AnimateHtml)clearInterval(frame_h_int),frame_h_int=setInterval(checkFrameHeight,200)},AnimateHtml.unwatchFrameHeight=function(){clearInterval(AnimateHtml.frame_h_int)},AnimateHtml.hasScroll=function(){with(this)return $(iframe).height()>$(blocker).height()});

//Tweens
window.AnimateHtml&&(AnimateHtml.default_transition="random",AnimateHtml.default_tween="easeInSine",AnimateHtml.transition_list=[],AnimateHtml.all_tweens="regularEaseIn regularEaseOut regularEaseInOut strongEaseIn strongEaseOut strongEaseInOut backEaseOut backEaseIn backEaseInOut bounceEaseOut bounceEaseIn bounceEaseInOut elasticEaseIn elasticEaseOut elasticEaseInOut".split(" "),AnimateHtml.useTransitions=function(a){AnimateHtml.transition_list=a},AnimateHtml.parseTransitionType=function(a){for(var a= (a.getAttribute("class")||"").split(" "),b=/^ah_transition_(.*)$/,c=0;c<a.length;c++){var d=b.exec(a[c]);if(d&&d[1])return d[1]}return"random"==AnimateHtml.default_transition?(a=Math.floor(Math.random()*AnimateHtml.transition_list.length),AnimateHtml.transition_list[a]):AnimateHtml.default_transition},AnimateHtml.getTweenType=function(a){with(this){if("random"==a)a=Math.floor(Math.random()*all_tweens.length),a=all_tweens[a];else if(!a||!this.all_tweens.find(a))a=this.default_tween;return a}}); Array.prototype.find=function(a){var b=false;for(i=0;i<this.length;i++)if(typeof a=="function"){if(a.test(this[i])){b||(b=[]);b.push(i)}}else if(this[i]===a){b||(b=[]);b.push(i)}return b};

//Permissions
window.AnimateHtml&&(AnimateHtml.domain=document.domain.replace(/^www\./i,""),AnimateHtml.ignore_rules=[],AnimateHtml.isSameDomain=function(a){return!a||this.domain==a},AnimateHtml.addIgnoreRule=function(a){this.ignore_rules.push(a)},AnimateHtml.isIgnored=function(a){with(this)for(var b=0;b<ignore_rules.length;b++)if(RegExp(ignore_rules[b]).test(a.url))return!0;return!1});

//Navigation
window.AnimateHtml&&(AnimateHtml.web_dir="",AnimateHtml.history_int=0,AnimateHtml.browser=jQuery.browser,AnimateHtml.addEventListener("init",function(){with(AnimateHtml){if(!web_dir){var a=getUrlInfo(window.location.href).relative;/\..*$/.test(a)&&(a=a.split("/"),delete a[a.length-1],a=a.join("/"));web_dir=a}(web_dir=trim(web_dir))&&(web_dir="/"+web_dir)}}),AnimateHtml.getLinkInfo=function(a){var b=this.getUrlInfo(a.toString()),a=$(a),c=a.attr("target");b.target=c?c.replace("_",""):"";a=a.attr("href"); b.internal=!a||"#"==a.charAt(0)?!0:!1;return b},AnimateHtml.setFrameUrl=function(){with(this){page2||(page2=index);removeFrameListeners();dispatchEvent("change_url");var a=getUrlInfo(page2);browser.msie?iframe.src="/"==toSiteRelativeUrl(a.relative)?AnimateHtml.index:page2:("/"==toSiteRelativeUrl(a.relative)?iframe.contentWindow.location.replace(AnimateHtml.index):iframe.contentWindow.location.replace(page2),window.location.hash=toSiteRelativeUrl(a.relative))}},AnimateHtml.getFrameUrl=function(){var a= (this.iframe.contentWindow.location.href+"").split("#")[0];return"about:blank"==a?AnimateHtml.index:a},AnimateHtml.getUrlMask=function(){with(this){var a=(window.location.href+"").split("#"),a=!a[1]||"/"==a[1]?getUrlInfo(index):getUrlInfo(a[1]);return toSiteRelativeUrl(a.relative)}},AnimateHtml.startCheckHistory=function(){AnimateHtml.stopCheckHistory();AnimateHtml.history_int=setInterval(AnimateHtml.checkHistory,200)},AnimateHtml.stopCheckHistory=function(){clearInterval(AnimateHtml.history_int)}, AnimateHtml.checkHistory=function(){with(AnimateHtml){var a=getFrameUrl(),b=getUrlInfo(a),a=getUrlMask(),b=toSiteRelativeUrl(b.relative);if(trim(b)!=trim(a)){if(!a||"/"==a){var c=getUrlInfo(index);if(trim(toSiteRelativeUrl(c.relative))==trim(b))return}browser.msie?window.location.replace("#"+b.replace("?wpt-wrapped=1","")):(removeFrameListeners(),iframe.contentWindow.location.replace(web_dir+a),stopCheckHistory())}}},AnimateHtml.getUrlInfo=function(a){var b={url:a},c=/^((http|https|ftp):\/\/(www\.)?([^\/]*))?(.*)$/i.exec(a); if(c[2])b.protocol=c[2];else{var d=/^([a-z]*):/i.exec(a);b.protocol=d&&d[1]?d[1]:"http"}b.domain=c[4]?c[4]:AnimateHtml.domain;d=c[5].split("#")[0];d=AnimateHtml.fixSlashes(d);b.relative="/"+AnimateHtml.ltrim(d);b.absolute=c[2]?a:b.protocol+"://"+b.domain+b.relative;return b},AnimateHtml.toSiteRelativeUrl=function(a){RegExp("^"+AnimateHtml.web_dir).test(a)&&(a=a.substring(AnimateHtml.web_dir.length));return AnimateHtml.fixSlashes(a)},AnimateHtml.trim=function(a){a=this.ltrim(a);return a=this.rtrim(a)}, AnimateHtml.ltrim=function(a){"/"==a.charAt(0)&&(a=a.substring(1));return a},AnimateHtml.rtrim=function(a){"/"==a.charAt(a.length-1)&&(a=a.substring(0,a.length-1));return a},AnimateHtml.fixSlashes=function(a){return a.replace(/\/{2,}/g,"/")});